function ae(e,t){return t.forEach(function(r){r&&typeof r!="string"&&!Array.isArray(r)&&Object.keys(r).forEach(function(s){if(s!=="default"&&!(s in e)){var o=Object.getOwnPropertyDescriptor(r,s);Object.defineProperty(e,s,o.get?o:{enumerable:!0,get:function(){return r[s]}})}})}),Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}const ue=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=r(o);fetch(o.href,n)}};ue();var D={exports:{}},f={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E=Symbol.for("react.element"),ce=Symbol.for("react.portal"),le=Symbol.for("react.fragment"),de=Symbol.for("react.strict_mode"),fe=Symbol.for("react.profiler"),pe=Symbol.for("react.provider"),ye=Symbol.for("react.context"),ge=Symbol.for("react.forward_ref"),he=Symbol.for("react.suspense"),me=Symbol.for("react.memo"),Ie=Symbol.for("react.lazy"),V=Symbol.iterator;function we(e){return e===null||typeof e!="object"?null:(e=V&&e[V]||e["@@iterator"],typeof e=="function"?e:null)}var G={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Y=Object.assign,Q={};function _(e,t,r){this.props=e,this.context=t,this.refs=Q,this.updater=r||G}_.prototype.isReactComponent={};_.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};_.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function X(){}X.prototype=_.prototype;function R(e,t,r){this.props=e,this.context=t,this.refs=Q,this.updater=r||G}var F=R.prototype=new X;F.constructor=R;Y(F,_.prototype);F.isPureReactComponent=!0;var H=Array.isArray,Z=Object.prototype.hasOwnProperty,N={current:null},ee={key:!0,ref:!0,__self:!0,__source:!0};function te(e,t,r){var s,o={},n=null,a=null;if(t!=null)for(s in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(n=""+t.key),t)Z.call(t,s)&&!ee.hasOwnProperty(s)&&(o[s]=t[s]);var u=arguments.length-2;if(u===1)o.children=r;else if(1<u){for(var i=Array(u),c=0;c<u;c++)i[c]=arguments[c+2];o.children=i}if(e&&e.defaultProps)for(s in u=e.defaultProps,u)o[s]===void 0&&(o[s]=u[s]);return{$$typeof:E,type:e,key:n,ref:a,props:o,_owner:N.current}}function _e(e,t){return{$$typeof:E,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function M(e){return typeof e=="object"&&e!==null&&e.$$typeof===E}function Ee(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var U=/\/+/g;function x(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Ee(""+e.key):t.toString(36)}function S(e,t,r,s,o){var n=typeof e;(n==="undefined"||n==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(n){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case E:case ce:a=!0}}if(a)return a=e,o=o(a),e=s===""?"."+x(a,0):s,H(o)?(r="",e!=null&&(r=e.replace(U,"$&/")+"/"),S(o,t,r,"",function(c){return c})):o!=null&&(M(o)&&(o=_e(o,r+(!o.key||a&&a.key===o.key?"":(""+o.key).replace(U,"$&/")+"/")+e)),t.push(o)),1;if(a=0,s=s===""?".":s+":",H(e))for(var u=0;u<e.length;u++){n=e[u];var i=s+x(n,u);a+=S(n,t,r,i,o)}else if(i=we(e),typeof i=="function")for(e=i.call(e),u=0;!(n=e.next()).done;)n=n.value,i=s+x(n,u++),a+=S(n,t,r,i,o);else if(n==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function P(e,t,r){if(e==null)return e;var s=[],o=0;return S(e,s,"","",function(n){return t.call(r,n,o++)}),s}function be(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var y={current:null},v={transition:null},Pe={ReactCurrentDispatcher:y,ReactCurrentBatchConfig:v,ReactCurrentOwner:N};function re(){throw Error("act(...) is not supported in production builds of React.")}f.Children={map:P,forEach:function(e,t,r){P(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return P(e,function(){t++}),t},toArray:function(e){return P(e,function(t){return t})||[]},only:function(e){if(!M(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};f.Component=_;f.Fragment=le;f.Profiler=fe;f.PureComponent=R;f.StrictMode=de;f.Suspense=he;f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pe;f.act=re;f.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=Y({},e.props),o=e.key,n=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(n=t.ref,a=N.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(i in t)Z.call(t,i)&&!ee.hasOwnProperty(i)&&(s[i]=t[i]===void 0&&u!==void 0?u[i]:t[i])}var i=arguments.length-2;if(i===1)s.children=r;else if(1<i){u=Array(i);for(var c=0;c<i;c++)u[c]=arguments[c+2];s.children=u}return{$$typeof:E,type:e.type,key:o,ref:n,props:s,_owner:a}};f.createContext=function(e){return e={$$typeof:ye,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:pe,_context:e},e.Consumer=e};f.createElement=te;f.createFactory=function(e){var t=te.bind(null,e);return t.type=e,t};f.createRef=function(){return{current:null}};f.forwardRef=function(e){return{$$typeof:ge,render:e}};f.isValidElement=M;f.lazy=function(e){return{$$typeof:Ie,_payload:{_status:-1,_result:e},_init:be}};f.memo=function(e,t){return{$$typeof:me,type:e,compare:t===void 0?null:t}};f.startTransition=function(e){var t=v.transition;v.transition={};try{e()}finally{v.transition=t}};f.unstable_act=re;f.useCallback=function(e,t){return y.current.useCallback(e,t)};f.useContext=function(e){return y.current.useContext(e)};f.useDebugValue=function(){};f.useDeferredValue=function(e){return y.current.useDeferredValue(e)};f.useEffect=function(e,t){return y.current.useEffect(e,t)};f.useId=function(){return y.current.useId()};f.useImperativeHandle=function(e,t,r){return y.current.useImperativeHandle(e,t,r)};f.useInsertionEffect=function(e,t){return y.current.useInsertionEffect(e,t)};f.useLayoutEffect=function(e,t){return y.current.useLayoutEffect(e,t)};f.useMemo=function(e,t){return y.current.useMemo(e,t)};f.useReducer=function(e,t,r){return y.current.useReducer(e,t,r)};f.useRef=function(e){return y.current.useRef(e)};f.useState=function(e){return y.current.useState(e)};f.useSyncExternalStore=function(e,t,r){return y.current.useSyncExternalStore(e,t,r)};f.useTransition=function(){return y.current.useTransition()};f.version="18.3.1";D.exports=f;var Se=D.exports,Ke=ae({__proto__:null,default:Se},[D.exports]),ve={exports:{}},$={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var De=D.exports,$e=Symbol.for("react.element"),Ae=Symbol.for("react.fragment"),xe=Object.prototype.hasOwnProperty,ke=De.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Le={key:!0,ref:!0,__self:!0,__source:!0};function ne(e,t,r){var s,o={},n=null,a=null;r!==void 0&&(n=""+r),t.key!==void 0&&(n=""+t.key),t.ref!==void 0&&(a=t.ref);for(s in t)xe.call(t,s)&&!Le.hasOwnProperty(s)&&(o[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)o[s]===void 0&&(o[s]=t[s]);return{$$typeof:$e,type:e,key:n,ref:a,props:o,_owner:ke.current}}$.Fragment=Ae;$.jsx=ne;$.jsxs=ne;ve.exports=$;const B=(e,t)=>t.some(r=>e instanceof r);let J,W;function Be(){return J||(J=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Te(){return W||(W=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const T=new WeakMap,k=new WeakMap,A=new WeakMap;function Oe(e){const t=new Promise((r,s)=>{const o=()=>{e.removeEventListener("success",n),e.removeEventListener("error",a)},n=()=>{r(I(e.result)),o()},a=()=>{s(e.error),o()};e.addEventListener("success",n),e.addEventListener("error",a)});return A.set(t,e),t}function Ce(e){if(T.has(e))return;const t=new Promise((r,s)=>{const o=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",a),e.removeEventListener("abort",a)},n=()=>{r(),o()},a=()=>{s(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",n),e.addEventListener("error",a),e.addEventListener("abort",a)});T.set(e,t)}let O={get(e,t,r){if(e instanceof IDBTransaction){if(t==="done")return T.get(e);if(t==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return I(e[t])},set(e,t,r){return e[t]=r,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function oe(e){O=e(O)}function je(e){return Te().includes(e)?function(...t){return e.apply(C(this),t),I(this.request)}:function(...t){return I(e.apply(C(this),t))}}function Re(e){return typeof e=="function"?je(e):(e instanceof IDBTransaction&&Ce(e),B(e,Be())?new Proxy(e,O):e)}function I(e){if(e instanceof IDBRequest)return Oe(e);if(k.has(e))return k.get(e);const t=Re(e);return t!==e&&(k.set(e,t),A.set(t,e)),t}const C=e=>A.get(e);function Fe(e,t,{blocked:r,upgrade:s,blocking:o,terminated:n}={}){const a=indexedDB.open(e,t),u=I(a);return s&&a.addEventListener("upgradeneeded",i=>{s(I(a.result),i.oldVersion,i.newVersion,I(a.transaction),i)}),r&&a.addEventListener("blocked",i=>r(i.oldVersion,i.newVersion,i)),u.then(i=>{n&&i.addEventListener("close",()=>n()),o&&i.addEventListener("versionchange",c=>o(c.oldVersion,c.newVersion,c))}).catch(()=>{}),u}const Ne=["get","getKey","getAll","getAllKeys","count"],Me=["put","add","delete","clear"],L=new Map;function q(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(L.get(t))return L.get(t);const r=t.replace(/FromIndex$/,""),s=t!==r,o=Me.includes(r);if(!(r in(s?IDBIndex:IDBObjectStore).prototype)||!(o||Ne.includes(r)))return;const n=async function(a,...u){const i=this.transaction(a,o?"readwrite":"readonly");let c=i.store;return s&&(c=c.index(u.shift())),(await Promise.all([c[r](...u),o&&i.done]))[0]};return L.set(t,n),n}oe(e=>({...e,get:(t,r,s)=>q(t,r)||e.get(t,r,s),has:(t,r)=>!!q(t,r)||e.has(t,r)}));const Ve=["continue","continuePrimaryKey","advance"],K={},j=new WeakMap,se=new WeakMap,He={get(e,t){if(!Ve.includes(t))return e[t];let r=K[t];return r||(r=K[t]=function(...s){j.set(this,se.get(this)[t](...s))}),r}};async function*Ue(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;t=t;const r=new Proxy(t,He);for(se.set(r,t),A.set(r,C(t));t;)yield r,t=await(j.get(r)||t.continue()),j.delete(r)}function z(e,t){return t===Symbol.asyncIterator&&B(e,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&B(e,[IDBIndex,IDBObjectStore])}oe(e=>({...e,get(t,r,s){return z(t,r)?Ue:e.get(t,r,s)},has(t,r){return z(t,r)||e.has(t,r)}}));async function g(){return await Fe("BookmarksDB",1,{upgrade(e){if(e.objectStoreNames.contains("pages")||e.createObjectStore("pages",{keyPath:"pageId"}),!e.objectStoreNames.contains("nodes")){const t=e.createObjectStore("nodes",{keyPath:"id"});t.createIndex("pageId","pageId"),t.createIndex("pId","pId")}if(!e.objectStoreNames.contains("urls")){const t=e.createObjectStore("urls",{keyPath:"id"});t.createIndex("pageId","pageId"),t.createIndex("gId","gId")}}})}function w(){return Math.random().toString(36).substr(2,9)}async function ze(e){try{const t=await g(),{pageId:r,title:s,createdAt:o,root:n,type:a}=e;await t.put("pages",{pageId:r,title:s,createdAt:o,updatedAt:o,type:a});async function u(i,c,d){const h=w();if(await t.put("nodes",{id:h,pageId:r,type:i.type,name:i.name,order:d,title:i.title,url:i.url||null,hide:!1,path:c?`${c},${h}`:`${h}`,pId:c,add_date:i.add_date,last_modified:i.last_modified,description:i.description,icon:i.icon}),Array.isArray(i.urlList))for(let l=0;l<i.urlList.length;l++){const p=i.urlList[l];await t.put("urls",{id:w(),pageId:r,gId:h,type:p.type,name:p.name,url:p.url,title:p.title,description:p.description,hide:p.hide,icon:p.icon,add_date:p.add_date})}if(Array.isArray(i.children))for(let l=0;l<i.children.length;l++)await u(i.children[l],h,l)}for(let i=0;i<n.length;i++)await u(n[i],null,i);return!0}catch(t){return console.error("savePageBookmarks error",t),!1}}async function Je(e,t){const r=await t.getAllFromIndex("nodes","pageId",e);r.sort((o,n)=>{var a,u;return((a=o.order)!=null?a:0)-((u=n.order)!=null?u:0)});function s(o){return r.filter(n=>n.pId===o).map(n=>{if(n.type==="folder"){const a=s(n.id);return{...n,status:1,children:a}}else return n})}return s(null)}async function Ge(){const e=await g(),s=await e.transaction("pages","readonly").objectStore("pages").getAll();if(s.length>0){const o=s.find(u=>u.default===!0),n=o?o.pageId:s[0].pageId;return await Je(n,e)}else return[{id:w(),name:"\u9ED8\u8BA4\u5206\u7EC4",type:"folder",status:0,children:[]}]}async function Ye(){return await(await g()).transaction("pages","readonly").objectStore("pages").getAll()}async function Qe(e){const r=(await g()).transaction("pages","readwrite"),s=r.objectStore("pages"),o=await s.getAll();for(const n of o)n.default=n.pageId===e,await s.put(n);await r.done}async function Xe(e){const t=await g(),{title:r,url:s,icon:o,groupId:n,status:a}=e;try{const u=await t.get("nodes",n),i={id:w(),pageId:u.pageId,gId:n,hide:!1,icon:o,name:r,description:r,type:"bookmark",url:s};return await t.put("urls",i),console.log("save success",i),!0}catch(u){return console.error("save error",u),!1}}async function Ze(e){try{const t=await g(),r=await t.get("pages",e),s=await t.getAllFromIndex("nodes","pageId",e),o=await t.getAllFromIndex("urls","pageId",e);return{pages:r?[r]:[],urls:o||[],nodes:s||[]}}catch(t){return console.error("exportPageJson error",t),null}}async function et(){try{const e=await g(),t=await e.getAll("pages"),r=await e.getAll("nodes"),s=await e.getAll("urls");return{pages:t||[],urls:s||[],nodes:r||[]}}catch(e){return console.error("exportAllPagesJson error",e),null}}async function tt(e){try{const t=await g(),{pages:r,nodes:s,urls:o}=e;if(!Array.isArray(r)||!Array.isArray(s)||!Array.isArray(o))throw new Error("\u5BFC\u5165\u5931\u8D25\uFF1AJSON \u6570\u636E\u683C\u5F0F\u65E0\u6548\u3002");const n={},a={},u=[],i=Date.now();let c=0;for(const l of r){const p=i+c++;n[l.pageId]=p,u.push(p);const m={...l,pageId:p,title:`${l.title}`,default:!1,createdAt:p,updatedAt:p};await t.put("pages",m)}const d=s.filter(l=>n[l.pageId]);d.sort((l,p)=>l.pId===null&&p.pId!==null?-1:l.pId!==null&&p.pId===null?1:0);for(const l of d){if(!n[l.pageId]){console.warn(`Skipping node ${l.id} as its pageId ${l.pageId} was not imported.`);continue}const p=l.id,m=w();a[p]=m;const ie=n[l.pageId],b=l.pId?a[l.pId]:null;l.pId&&!b&&console.warn(`Parent node ${l.pId} for node ${l.id} not found in mapping. Treating as root.`),await t.put("nodes",{...l,id:m,pageId:ie,pId:b,path:b?`${b},${m}`:`${m}`})}const h=o.filter(l=>n[l.pageId]);for(const l of h){if(!n[l.pageId]){console.warn(`Skipping URL ${l.id} as its pageId ${l.pageId} was not imported.`);continue}const p=n[l.pageId],m=l.gId?a[l.gId]:null;l.gId&&!m&&console.warn(`Group node ${l.gId} for URL ${l.id} not found in mapping.`),await t.put("urls",{...l,id:w(),pageId:p,gId:m})}return u}catch(t){return console.error("importJson error",t),null}}async function rt(e){try{const t=await g();await t.delete("pages",e);const r=await t.getAllFromIndex("nodes","pageId",e);for(const o of r)await t.delete("nodes",o.id);const s=await t.getAllFromIndex("urls","pageId",e);for(const o of s)await t.delete("urls",o.id);return!0}catch{return!1}}async function We(e){const t=await g(),r=await t.getAllFromIndex("nodes","pageId",e);r.sort((n,a)=>{var u,i;return((u=n.order)!=null?u:0)-((i=a.order)!=null?i:0)});const s=await t.getAllFromIndex("urls","pageId",e);function o(n){return r.filter(a=>a.pId===n).map(a=>{if(a.type==="folder"){const u=o(a.id),i=s.filter(c=>c.gId===a.id);if(i&&i.length>0&&u.length>0){const c={...a,children:[],urlList:i};return{...a,children:[c,...u]}}else return{...a,children:u,urlList:i}}else return a})}return o(null)}function qe(e){const t=JSON.parse(JSON.stringify(e));function r(s){if(!!Array.isArray(s))for(let o=0;o<s.length;o++){const n=s[o];if(n.type==="folder"&&Array.isArray(n.children)&&n.children.length>0){const a=n.children.findIndex(u=>u.path===n.path);if(a!==-1){const u=n.children[a];n.urlList=u.urlList,n.children.splice(a,1)}r(n.children)}}}return r(t),t}async function nt(e){const t=await We(e),r=qe(t),s=["\u4E66\u7B7E\u680F","\u6536\u85CF\u5939\u680F","\u4E66\u7B7E\u5DE5\u5177\u680F"],o=["\u79FB\u52A8\u8BBE\u5907\u548C\u5176\u4ED6\u4E66\u7B7E","\u79FB\u52A8\u548C\u5176\u4ED6\u6536\u85CF\u5939","\u5176\u4ED6\u4E66\u7B7E"];function n(u,i=0){let c="";for(const d of u){if(i===0){if(s.includes(d.name)){d.urlList&&d.urlList.length>0&&(c+=n(d.urlList,i)),d.children&&d.children.length>0&&(c+=n(d.children,i));continue}else if(o.includes(d.name)){d.urlList&&d.urlList.length>0&&(c+=`${"  ".repeat(i)}<DT><H3>${d.name||d.title}</H3>
`,c+=`${"  ".repeat(i)}<DL><p>
`,d.urlList&&d.urlList.length>0&&(c+=n(d.urlList,i+1)),c+=`${"  ".repeat(i)}</DL><p>
`),d.children&&d.children.length>0&&(c+=n(d.children,i));continue}}if(d.type==="folder")c+=`${"  ".repeat(i)}<DT><H3>${d.name||d.title}</H3>
`,c+=`${"  ".repeat(i)}<DL><p>
`,d.children&&d.children.length>0&&(c+=n(d.children,i+1)),d.urlList&&d.urlList.length>0&&(c+=n(d.urlList,i+1)),c+=`${"  ".repeat(i)}</DL><p>
`;else{const h=Math.floor((d.add_date||Date.now())/1e3),l=Math.floor((d.last_modified||d.add_date||Date.now())/1e3);c+=`${"  ".repeat(i)}<DT><A HREF="${d.url}" ADD_DATE="${h}" LAST_VISIT="${l}" ICON="${d.icon||""}">${d.name||d.title}</A>
`}}return c}let a=`<!DOCTYPE NETSCAPE-Bookmark-file-1>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8">
<TITLE>Bookmarks</TITLE>
<H1>Bookmarks</H1>
<DL><p>
`;return a+=n(r),a+=`</DL><p>
`,a}export{Ke as R,Se as a,nt as b,Ye as c,ze as d,Ze as e,Ge as f,g,rt as h,tt as i,ve as j,et as k,Xe as l,D as r,Qe as s};
